<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>PEDIAPAY TOPUP GAMES</title>
  <!-- Add Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    .banner-wrapper {
      position: relative;
      width: 100%;
      border-radius: 10px;
      overflow: hidden;
      height: 120px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .banner-container {
      display: flex;
      height: 100%;
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .banner-slide {
      min-width: 100%;
      flex-shrink: 0;
      position: relative;
    }
    .banner-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .banner-slide::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40%;
      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    }
    .banner-dots {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 10;
    }
    .banner-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255,255,255,0.5);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .banner-dot.active {
      background: white;
      transform: scale(1.3);
    }
    .game-card {
      transition: all 0.3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .game-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
    }
    .nav-button {
      transition: all 0.2s ease;
    }
    .nav-button.active {
      color: #7B5FFF;
      transform: scale(1.1);
    }
    .nav-button:active {
      transform: scale(0.95);
    }
    .top-up-btn {
      transition: all 0.2s ease;
      box-shadow: 0 2px 4px rgba(123, 95, 255, 0.3);
    }
    .top-up-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(123, 95, 255, 0.4);
    }
    .top-up-btn:active {
      transform: translateY(0);
    }
    .discount-badge {
      transition: all 0.2s ease;
    }
    .discount-badge:hover {
      transform: scale(1.05);
    }
    ::-webkit-scrollbar {
      width: 5px;
      height: 5px;
    }
    ::-webkit-scrollbar-track {
      background: #3B2E7E;
    }
    ::-webkit-scrollbar-thumb {
      background: #7B5FFF;
      border-radius: 10px;
    }
    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      z-index: 100;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .modal-content {
      background-color: #3B2E7E;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      animation: slideUp 0.3s ease;
    }
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .close-btn:hover {
      color: #7B5FFF;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    .form-group input {
      width: 100%;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #6B63B5;
      background-color: #2B2360;
      color: white;
      transition: all 0.2s ease;
    }
    .form-group input:focus {
      outline: none;
      border-color: #7B5FFF;
      box-shadow: 0 0 0 2px rgba(123, 95, 255, 0.3);
    }
    .auth-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #6B63B5;
    }
    .auth-tab {
      flex: 1;
      text-align: center;
      padding: 10px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
    }
    .auth-tab.active {
      border-bottom: 2px solid #7B5FFF;
      color: #7B5FFF;
      font-weight: 600;
    }
    .auth-tab:hover:not(.active) {
      color: #A97FFF;
    }
    .error-message {
      color: #FF5F7E;
      font-size: 12px;
      margin-top: 5px;
      display: none;
    }
    .divider {
      display: flex;
      align-items: center;
      margin: 15px 0;
      color: #6B63B5;
      font-size: 12px;
    }
    .divider::before, .divider::after {
      content: "";
      flex: 1;
      border-bottom: 1px solid #6B63B5;
      margin: 0 10px;
    }
    .social-login-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 10px;
      border-radius: 5px;
      background: #2B2360;
      color: white;
      font-weight: 500;
      margin-bottom: 10px;
      transition: all 0.2s ease;
      border: 1px solid transparent;
    }
    .social-login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .social-login-btn i {
      margin-right: 10px;
      font-size: 18px;
    }
    .google-btn {
      border: 1px solid #6B63B5;
    }
    .google-btn:hover {
      border-color: #7B5FFF;
    }
    .google-btn i {
      color: #DB4437;
    }
    .auth-footer {
      text-align: center;
      margin-top: 15px;
      font-size: 13px;
      color: #B9B9B9;
    }
    .auth-footer a {
      color: #7B5FFF;
      font-weight: 500;
      text-decoration: none;
      transition: all 0.2s ease;
    }
    .auth-footer a:hover {
      text-decoration: underline;
    }
    /* Loading spinner */
    .spinner {
      width: 24px;
      height: 24px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      display: inline-block;
      vertical-align: middle;
      margin-right: 8px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    /* Game categories */
    .category-tab {
      transition: all 0.2s ease;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
    }
    .category-tab.active {
      background: #7B5FFF;
      color: white;
    }
    .category-tab:not(.active):hover {
      background: #3B2E7E;
    }
    /* Payment methods */
    .payment-method {
      border: 1px solid #6B63B5;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
      transition: all 0.2s ease;
      cursor: pointer;
    }
    .payment-method:hover {
      border-color: #7B5FFF;
      transform: translateY(-2px);
    }
    .payment-method.selected {
      border-color: #7B5FFF;
      background: rgba(123, 95, 255, 0.1);
    }
    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: #3B2E7E;
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      display: flex;
      align-items: center;
      animation: slideIn 0.3s ease, fadeOut 0.5s ease 2.5s forwards;
    }
    @keyframes slideIn {
      from { bottom: 20px; opacity: 0; }
      to { bottom: 80px; opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    .toast i {
      margin-right: 10px;
      font-size: 18px;
    }
    .toast.success i {
      color: #5FFF8B;
    }
    .toast.error i {
      color: #FF5F7E;
    }
    /* Top-up modal */
    .topup-item {
      border: 1px solid #6B63B5;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
      transition: all 0.2s ease;
      cursor: pointer;
    }
    .topup-item:hover {
      border-color: #7B5FFF;
      transform: translateY(-2px);
    }
    .topup-item.selected {
      border-color: #7B5FFF;
      background: rgba(123, 95, 255, 0.1);
    }
    /* History item */
    .history-item {
      border-bottom: 1px solid #6B63B5;
      padding: 12px 0;
    }
    .history-item:last-child {
      border-bottom: none;
    }
  </style>
</head>
<body class="bg-[#2B2360] text-white min-h-screen flex flex-col">
  <!-- Login/Register Modal -->
  <div id="authModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeModal">&times;</span>
      <div class="auth-tabs">
        <div class="auth-tab active" id="loginTab">Login</div>
        <div class="auth-tab" id="registerTab">Daftar</div>
      </div>
      
      <!-- Login Form -->
      <div id="loginForm">
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" placeholder="Masukkan email Anda">
          <div class="error-message" id="loginEmailError"></div>
        </div>
        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" placeholder="Masukkan password Anda">
          <div class="error-message" id="loginPasswordError"></div>
        </div>
        <button class="w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-sm font-semibold mt-4 flex items-center justify-center" id="loginBtn">
          <span id="loginBtnText">Login</span>
          <div id="loginSpinner" class="spinner" style="display: none;"></div>
        </button>
        
        <div class="divider">atau lanjutkan dengan</div>
        
        <!-- Social Login Buttons -->
        <button class="social-login-btn google-btn" id="googleLoginBtn">
          <img src="https://files.catbox.moe/q57b5t.png" alt="Google logo" class="w-5 h-5 mr-2">
          Login dengan Google
        </button>
        
        <div class="text-center mt-4 text-sm">
          Lupa password? <a href="#" class="text-[#7B5FFF]" id="forgotPassword">Klik di sini</a>
        </div>
        
        <div class="auth-footer">
          Belum punya akun? <a href="#" id="switchToRegister">Daftar sekarang</a>
        </div>
      </div>
      
      <!-- Register Form -->
      <div id="registerForm" style="display: none;">
        <div class="form-group">
          <label for="registerName">Nama Lengkap</label>
          <input type="text" id="registerName" placeholder="Masukkan nama lengkap Anda">
          <div class="error-message" id="registerNameError"></div>
        </div>
        <div class="form-group">
          <label for="registerEmail">Email</label>
          <input type="email" id="registerEmail" placeholder="Masukkan email Anda">
          <div class="error-message" id="registerEmailError"></div>
        </div>
        <div class="form-group">
          <label for="registerPhone">Nomor Telepon</label>
          <input type="tel" id="registerPhone" placeholder="Masukkan nomor telepon">
          <div class="error-message" id="registerPhoneError"></div>
        </div>
        <div class="form-group">
          <label for="registerPassword">Password</label>
          <input type="password" id="registerPassword" placeholder="Masukkan password (min. 6 karakter)">
          <div class="error-message" id="registerPasswordError"></div>
        </div>
        <div class="form-group">
          <label for="registerConfirmPassword">Konfirmasi Password</label>
          <input type="password" id="registerConfirmPassword" placeholder="Konfirmasi password Anda">
          <div class="error-message" id="registerConfirmPasswordError"></div>
        </div>
        <button class="w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-sm font-semibold mt-4 flex items-center justify-center" id="registerBtn">
          <span id="registerBtnText">Daftar</span>
          <div id="registerSpinner" class="spinner" style="display: none;"></div>
        </button>
        
        <div class="divider">atau daftar dengan</div>
        
        <!-- Social Register Buttons -->
        <button class="social-login-btn google-btn" id="googleRegisterBtn">
          <img src="https://files.catbox.moe/q57b5t.png" alt="Google logo" class="w-5 h-5 mr-2">
          Daftar dengan Google
        </button>
        
        <div class="auth-footer">
          Sudah punya akun? <a href="#" id="switchToLogin">Login sekarang</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Info Modal -->
  <div id="accountModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeAccountModal">&times;</span>
      <h2 class="text-xl font-bold mb-4 text-center">Informasi Akun</h2>
      <div id="accountInfo">
        <!-- Account info will be loaded here -->
      </div>
      <div class="mt-4">
        <button class="w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-sm font-semibold mb-2" id="topupBalanceBtn">
          Top Up Saldo
        </button>
        <button class="w-full bg-[#3B2E7E] border border-[#6B63B5] rounded-md py-2 text-sm font-semibold mb-2" id="historyBtn">
          Riwayat Transaksi
        </button>
        <button class="w-full bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-md py-2 text-sm font-semibold" id="logoutBtn">
          Logout
        </button>
      </div>
    </div>
  </div>

  <!-- Top-up Balance Modal -->
  <div id="topupModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeTopupModal">&times;</span>
      <h2 class="text-xl font-bold mb-4 text-center">Top Up Saldo</h2>
      
      <div class="form-group">
        <label for="topupAmount">Jumlah Top Up</label>
        <input type="number" id="topupAmount" placeholder="Masukkan jumlah (min. Rp 10.000)">
        <div class="error-message" id="topupAmountError"></div>
      </div>
      
      <div class="mt-3 mb-2 font-medium">Metode Pembayaran</div>
      
      <div class="payment-method" data-method="gopay">
        <div class="flex items-center">
          <img src="https://files.catbox.moe/4k8b0v.png" alt="Gopay" class="w-8 h-8 mr-3">
          <div>
            <div class="font-medium">Gopay</div>
            <div class="text-xs text-[#B9B9B9]">Biaya admin Rp 2.500</div>
          </div>
        </div>
      </div>
      
      <div class="payment-method" data-method="ovo">
        <div class="flex items-center">
          <img src="https://files.catbox.moe/5l5k5v.png" alt="OVO" class="w-8 h-8 mr-3">
          <div>
            <div class="font-medium">OVO</div>
            <div class="text-xs text-[#B9B9B9]">Biaya admin Rp 2.500</div>
          </div>
        </div>
      </div>
      
      <div class="payment-method" data-method="dana">
        <div class="flex items-center">
          <img src="https://files.catbox.moe/3vxnc0.png" alt="DANA" class="w-8 h-8 mr-3">
          <div>
            <div class="font-medium">DANA</div>
            <div class="text-xs text-[#B9B9B9]">Biaya admin Rp 2.500</div>
          </div>
        </div>
      </div>
      
      <div class="payment-method" data-method="bank">
        <div class="flex items-center">
          <img src="https://files.catbox.moe/8tlhg4.png" alt="Bank Transfer" class="w-8 h-8 mr-3">
          <div>
            <div class="font-medium">Transfer Bank</div>
            <div class="text-xs text-[#B9B9B9]">Biaya admin Rp 3.000</div>
          </div>
        </div>
      </div>
      
      <div class="error-message" id="paymentMethodError" style="margin-top: 10px;"></div>
      
      <button class="w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-sm font-semibold mt-4 flex items-center justify-center" id="confirmTopupBtn">
        <span id="confirmTopupBtnText">Lanjutkan Pembayaran</span>
        <div id="confirmTopupSpinner" class="spinner" style="display: none;"></div>
      </button>
    </div>
  </div>

  <!-- Payment Confirmation Modal -->
  <div id="paymentModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closePaymentModal">&times;</span>
      <h2 class="text-xl font-bold mb-4 text-center">Konfirmasi Pembayaran</h2>
      
      <div id="paymentDetails">
        <!-- Payment details will be loaded here -->
      </div>
      
      <button class="w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-sm font-semibold mt-4" id="completePaymentBtn">
        Saya Sudah Bayar
      </button>
      
      <button class="w-full bg-[#3B2E7E] border border-[#6B63B5] rounded-md py-2 text-sm font-semibold mt-2" id="cancelPaymentBtn">
        Batalkan
      </button>
    </div>
  </div>

  <!-- History Modal -->
  <div id="historyModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeHistoryModal">&times;</span>
      <h2 class="text-xl font-bold mb-4 text-center">Riwayat Transaksi</h2>
      
      <div class="flex space-x-2 mb-4 overflow-x-auto pb-2">
        <button class="category-tab active" data-category="all">Semua</button>
        <button class="category-tab" data-category="topup">Top Up</button>
        <button class="category-tab" data-category="game">Game</button>
        <button class="category-tab" data-category="voucher">Voucher</button>
      </div>
      
      <div id="historyList">
        <!-- History items will be loaded here -->
        <div class="text-center py-10 text-[#B9B9B9]">
          <i class="fas fa-history text-3xl mb-2"></i>
          <p>Belum ada riwayat transaksi</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Game Top-up Modal -->
  <div id="gameTopupModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeGameTopupModal">&times;</span>
      <h2 class="text-xl font-bold mb-4 text-center" id="gameTopupTitle">Top Up Diamond Mobile Legends</h2>
      
      <div class="form-group">
        <label for="gamePlayerId">ID Player</label>
        <input type="text" id="gamePlayerId" placeholder="Masukkan ID Player">
        <div class="error-message" id="gamePlayerIdError"></div>
      </div>
      
      <div class="form-group">
        <label for="gameServerId">Server ID (Opsional)</label>
        <input type="text" id="gameServerId" placeholder="Masukkan Server ID">
      </div>
      
      <div class="mt-3 mb-2 font-medium">Pilih Nominal</div>
      
      <div class="grid grid-cols-2 gap-3" id="topupOptions">
        <!-- Top-up options will be loaded here -->
      </div>
      
      <div class="error-message" id="topupOptionError" style="margin-top: 10px;"></div>
      
      <button class="w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-sm font-semibold mt-4 flex items-center justify-center" id="confirmGameTopupBtn">
        <span id="confirmGameTopupBtnText">Lanjutkan Pembayaran</span>
        <div id="confirmGameTopupSpinner" class="spinner" style="display: none;"></div>
      </button>
    </div>
  </div>

  <div class="px-5 pt-5 pb-3 flex justify-between items-center bg-[#2B2360] sticky top-0 z-10">
    <div class="flex items-center space-x-2">
      <img alt="Pediapay logo" class="w-10 h-10 rounded-lg" src="https://files.catbox.moe/wstnsp.webp"/>
      <span class="font-extrabold text-white text-xl select-none">PEDIAPAY</span>
    </div>
    <div class="flex items-center space-x-3">
      <button class="p-2 rounded-full bg-[#3B2E7E] text-white relative" id="notificationBtn">
        <i class="fas fa-bell"></i>
        <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full" id="notificationBadge" style="display: none;"></span>
      </button>
      <button class="bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-lg px-4 py-2 text-white text-sm font-semibold shadow-lg" id="authButton">
        Login/Daftar
      </button>
    </div>
  </div>

  <div class="px-5 space-y-4 flex-1 overflow-y-auto pb-24">
    <!-- Search Bar -->
    <div class="relative">
      <input type="text" placeholder="Cari game, voucher, atau produk..." 
             class="w-full bg-[#3B2E7E] rounded-xl py-3 px-4 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-[#7B5FFF] placeholder-[#6B63B5]">
      <i class="fas fa-search absolute right-3 top-3 text-[#6B63B5]"></i>
    </div>

    <!-- Banner Section with Sliding Animation -->
    <div class="banner-wrapper">
      <div class="banner-container" id="bannerContainer">
        <div class="banner-slide">
          <img src="https://files.catbox.moe/8tlhg4.jpg" alt="Banner 1">
          <div class="absolute bottom-3 left-3 z-10 text-white text-sm font-bold"></div>
        </div>
        <div class="banner-slide">
          <img src="https://files.catbox.moe/hgmk3d.jpg" alt="Banner 2">
          <div class="absolute bottom-3 left-3 z-10 text-white text-sm font-bold">Event Spesial Bulan Ini</div>
        </div>
        <div class="banner-slide">
          <img src="https://files.catbox.moe/i18860.jpg" alt="Banner 3">
          <div class="absolute bottom-3 left-3 z-10 text-white text-sm font-bold">Game Baru Tersedia</div>
        </div>
        <div class="banner-slide">
          <img src="https://files.catbox.moe/9h9gjs.jpg" alt="Banner 4">
          <div class="absolute bottom-3 left-3 z-10 text-white text-sm font-bold">Bonus Diamond MLBB</div>
        </div>
        <div class="banner-slide">
          <img src="https://files.catbox.moe/rl7wgh.jpg" alt="Banner 5">
          <div class="absolute bottom-3 left-3 z-10 text-white text-sm font-bold">Voucher Gratis</div>
        </div>
        <div class="banner-slide">
          <img src="https://files.catbox.moe/i8rk6z.jpg" alt="Banner 6">
          <div class="absolute bottom-3 left-3 z-10 text-white text-sm font-bold">Cashback 10%</div>
        </div>
      </div>
      <div class="banner-dots">
        <div class="banner-dot active" data-slide="0"></div>
        <div class="banner-dot" data-slide="1"></div>
        <div class="banner-dot" data-slide="2"></div>
        <div class="banner-dot" data-slide="3"></div>
        <div class="banner-dot" data-slide="4"></div>
        <div class="banner-dot" data-slide="5"></div>
      </div>
    </div>

    <!-- Promo Categories -->
    <div class="grid grid-cols-4 gap-3 pt-2">
      <div class="bg-[#3B2E7E] rounded-xl p-2 flex flex-col items-center">
        <div class="w-10 h-10 bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-full flex items-center justify-center mb-1">
          <i class="fas fa-percentage text-white"></i>
        </div>
        <span class="text-xs text-center">Diskon</span>
      </div>
      <div class="bg-[#3B2E7E] rounded-xl p-2 flex flex-col items-center">
        <div class="w-10 h-10 bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-full flex items-center justify-center mb-1">
          <i class="fas fa-gift text-white"></i>
        </div>
        <span class="text-xs text-center">Promo</span>
      </div>
      <div class="bg-[#3B2E7E] rounded-xl p-2 flex flex-col items-center">
        <div class="w-10 h-10 bg-gradient-to-r from-[#5F8BFF] to-[#7FA9FF] rounded-full flex items-center justify-center mb-1">
          <i class="fas fa-coins text-white"></i>
        </div>
        <span class="text-xs text-center">Cashback</span>
      </div>
      <div class="bg-[#3B2E7E] rounded-xl p-2 flex flex-col items-center">
        <div class="w-10 h-10 bg-gradient-to-r from-[#5FFF8B] to-[#7FFFA9] rounded-full flex items-center justify-center mb-1">
          <i class="fas fa-ticket-alt text-white"></i>
        </div>
        <span class="text-xs text-center">Voucher</span>
      </div>
    </div>

    <div class="flex justify-between items-center mt-3">
      <div>
        <h2 class="text-[#6B63B5] font-semibold text-lg select-none">
          Game <span class="font-bold text-white">Populer</span>
        </h2>
        <p class="text-[#6B63B5] text-sm select-none">
          Game yang paling banyak di topup saat ini...
        </p>
      </div>
      <button class="text-white text-xs font-semibold bg-[#3B2E7E] rounded-md px-3 py-1 flex items-center space-x-1 select-none hover:bg-[#4A3D8E] transition">
        <span>Lihat Semua</span>
        <i class="fas fa-arrow-up-right-from-square text-xs"></i>
      </button>
    </div>

    <!-- Game Grid -->
    <div class="grid grid-cols-2 gap-4">
      <!-- Mobile Legends -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="Mobile Legends Bang Bang" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/q3s2it.png"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-10%</span>
          </div>
          <div class="absolute bottom-2 left-2 bg-black bg-opacity-50 rounded-md px-2 py-0.5 text-xs">
            <i class="fas fa-fire text-orange-400"></i>
            <span class="text-white">Trending</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Mobile Legends
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Moonton
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Mobile Legends" data-game-id="mlbb">
          Top Up Sekarang
        </button>
      </div>

      <!-- Genshin Impact -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="Genshin Impact game" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/6l0830.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-15%</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Genshin Impact
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Hoyoverse
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Genshin Impact" data-game-id="genshin">
          Top Up Sekarang
        </button>
      </div>

      <!-- Free Fire -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="Free Fire" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/byekcx.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#5F8BFF] to-[#7FA9FF] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-5%</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Free Fire
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Garena
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Free Fire" data-game-id="freefire">
          Top Up Sekarang
        </button>
      </div>

      <!-- PUBG Mobile -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="PUBG Mobile" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/pgnf4o.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#5F8BFF] to-[#7FA9FF] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-8%</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          PUBG Mobile
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Tencent
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="PUBG Mobile" data-game-id="pubgm">
          Top Up Sekarang
        </button>
      </div>

      <!-- Honor of Kings -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="Honor Of Kings" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/xiyt8w.png"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#5FFF8B] to-[#7FFFA9] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-12%</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Honor of Kings
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Timi Studios
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Honor of Kings" data-game-id="honor">
          Top Up Sekarang
        </button>
      </div>

      <!-- Magic Chess -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="magic chess go go" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/kmq6c4.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#5FFF8B] to-[#7FFFA9] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-7%</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Magic Chess
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Vizta Games
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Magic Chess" data-game-id="magicchess">
          Top Up Sekarang
        </button>
      </div>

      <!-- Free Fire MAX -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="Free Fire Max" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/js5s11.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-10%</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Free Fire MAX
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Garena
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Free Fire MAX" data-game-id="freefiremax">
          Top Up Sekarang
        </button>
      </div>

      <!-- Honkai Star Rail -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="Honkai: star rail" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/go1xod.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-15%</span>
          </div>
          <div class="absolute bottom-2 left-2 bg-black bg-opacity-50 rounded-md px-2 py-0.5 text-xs">
            <i class="fas fa-star text-yellow-400"></i>
            <span class="text-white">New</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Honkai Star Rail
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Hoyoverse
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Honkai Star Rail" data-game-id="honkaistarrail">
          Top Up Sekarang
        </button>
      </div>
      
      <!-- EA SPORTS FC mobile -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="EA SPORTS FC mobile" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/0zm8gm.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-15%</span>
          </div>
          <div class="absolute bottom-2 left-2 bg-black bg-opacity-50 rounded-md px-2 py-0.5 text-xs">
            <i class="fas fa-star text-yellow-400"></i>
            <span class="text-white">New</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          EA SPORTS FC
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          FC Games
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="EA SPORTS FC" data-game-id="easportsfc">
          Top Up Sekarang
        </button>
      </div>
      
      <!-- Clash of Clans -->
      <div class="game-card bg-[#3B2E7E] rounded-xl p-3 space-y-2">
        <div class="relative">
          <img alt="Clash of Clans" class="rounded-lg w-full h-28 object-cover" src="https://files.catbox.moe/3vxnc0.jpg"/>
          <div class="discount-badge absolute top-2 right-2 bg-gradient-to-r from-[#FF5F7E] to-[#FF8A9B] rounded-md px-2 py-0.5 text-xs font-semibold flex items-center space-x-1 select-none">
            <i class="fas fa-gem text-white"></i>
            <span class="text-white">-15%</span>
          </div>
          <div class="absolute bottom-2 left-2 bg-black bg-opacity-50 rounded-md px-2 py-0.5 text-xs">
            <i class="fas fa-star text-yellow-400"></i>
            <span class="text-white">New</span>
          </div>
        </div>
        <h3 class="font-bold text-white text-sm select-none">
          Clash of Clans
        </h3>
        <p class="text-[#B9B9B9] text-xs select-none">
          Supercell
        </p>
        <button class="top-up-btn w-full bg-gradient-to-r from-[#7B5FFF] to-[#A97FFF] rounded-md py-2 text-xs font-semibold" data-game="Clash of Clans" data-game-id="clashofclans">
          Top Up Sekarang
        </button>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="fixed bottom-0 left-0 w-full bg-[#3B2E7E] border-t border-[#6B63B5] flex justify-around items-center py-3 text-xs font-semibold select-none">
    <button class="nav-button active flex flex-col items-center text-[#7B5FFF]">
      <i class="fas fa-home text-lg mb-1"></i>
      <span>Home</span>
    </button>
    <button class="nav-button flex flex-col items-center text-[#B9B9B9]">
      <i class="fas fa-gamepad text-lg mb-1"></i>
      <span>Game</span>
    </button>
    <button class="nav-button flex flex-col items-center text-[#B9B9B9]">
      <i class="fas fa-gem text-lg mb-1"></i>
      <span>TopUp</span>
    </button>
    <button class="nav-button flex flex-col items-center text-[#B9B9B9]" id="accountButton">
      <i class="fas fa-user text-lg mb-1"></i>
      <span>Akun</span>
    </button>
  </nav>

  <script>
    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyA5LfKdQ3ThSh0h0yzwq8htedfYti_hbxQ",
      authDomain: "pediapay-topup.firebaseapp.com",
      projectId: "pediapay-topup",
      storageBucket: "pediapay-topup.appspot.com",
      messagingSenderId: "1008551355050",
      appId: "1:1008551355050:web:abbb58878d9639656aa6d3",
      measurementId: "G-26J59222HY"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    
    // Initialize Google Auth Provider
    const provider = new firebase.auth.GoogleAuthProvider();

    // Game top-up data
    const gameTopupOptions = {
      mlbb: [
        { amount: 5, price: 1000, bonus: 0 },
        { amount: 12, price: 2000, bonus: 0 },
        { amount: 28, price: 5000, bonus: 2 },
        { amount: 59, price: 10000, bonus: 5 },
        { amount: 145, price: 25000, bonus: 15 },
        { amount: 310, price: 50000, bonus: 35 },
        { amount: 650, price: 100000, bonus: 80 },
        { amount: 1400, price: 200000, bonus: 200 }
      ],
      genshin: [
        { amount: 60, price: 15000, bonus: 0 },
        { amount: 300, price: 75000, bonus: 30 },
        { amount: 980, price: 250000, bonus: 110 },
        { amount: 1980, price: 500000, bonus: 260 },
        { amount: 3280, price: 800000, bonus: 600 },
        { amount: 6480, price: 1500000, bonus: 1600 }
      ],
      freefire: [
        { amount: 5, price: 1000, bonus: 0 },
        { amount: 12, price: 2000, bonus: 0 },
        { amount: 50, price: 10000, bonus: 5 },
        { amount: 100, price: 20000, bonus: 12 },
        { amount: 250, price: 50000, bonus: 35 },
        { amount: 500, price: 100000, bonus: 80 },
        { amount: 1000, price: 200000, bonus: 200 }
      ],
      pubgm: [
        { amount: 35, price: 5000, bonus: 0 },
        { amount: 70, price: 10000, bonus: 5 },
        { amount: 350, price: 50000, bonus: 35 },
        { amount: 720, price: 100000, bonus: 80 },
        { amount: 1450, price: 200000, bonus: 200 }
      ],
      honor: [
        { amount: 5, price: 1000, bonus: 0 },
        { amount: 12, price: 2000, bonus: 0 },
        { amount: 28, price: 5000, bonus: 2 },
        { amount: 59, price: 10000, bonus: 5 },
        { amount: 145, price: 25000, bonus: 15 },
        { amount: 310, price: 50000, bonus: 35 },
        { amount: 650, price: 100000, bonus: 80 }
      ],
      magicchess: [
        { amount: 5, price: 1000, bonus: 0 },
        { amount: 12, price: 2000, bonus: 0 },
        { amount: 28, price: 5000, bonus: 2 },
        { amount: 59, price: 10000, bonus: 5 },
        { amount: 145, price: 25000, bonus: 15 }
      ],
      freefiremax: [
        { amount: 5, price: 1000, bonus: 0 },
        { amount: 12, price: 2000, bonus: 0 },
        { amount: 50, price: 10000, bonus: 5 },
        { amount: 100, price: 20000, bonus: 12 },
        { amount: 250, price: 50000, bonus: 35 },
        { amount: 500, price: 100000, bonus: 80 }
      ],
      honkaistarrail: [
        { amount: 60, price: 15000, bonus: 0 },
        { amount: 300, price: 75000, bonus: 30 },
        { amount: 980, price: 250000, bonus: 110 },
        { amount: 1980, price: 500000, bonus: 260 },
        { amount: 3280, price: 800000, bonus: 600 }
      ],
      easportsfc: [
        { amount: 100, price: 15000, bonus: 0 },
        { amount: 500, price: 75000, bonus: 50 },
        { amount: 1000, price: 150000, bonus: 120 },
        { amount: 2500, price: 350000, bonus: 350 },
        { amount: 5000, price: 700000, bonus: 800 }
      ],
      clashofclans: [
        { amount: 80, price: 10000, bonus: 0 },
        { amount: 500, price: 60000, bonus: 20 },
        { amount: 1200, price: 150000, bonus: 80 },
        { amount: 2500, price: 300000, bonus: 200 },
        { amount: 6500, price: 800000, bonus: 600 }
      ]
    };

    document.addEventListener('DOMContentLoaded', function() {
      // Banner Slider
      const container = document.getElementById('bannerContainer');
      const dots = document.querySelectorAll('.banner-dot');
      const slideCount = document.querySelectorAll('.banner-slide').length;
      let currentIndex = 0;
      let interval;

      function goToSlide(index) {
        currentIndex = (index + slideCount) % slideCount;
        container.style.transform = `translateX(-${currentIndex * 100}%)`;
        
        // Update dots
        dots.forEach((dot, i) => {
          dot.classList.toggle('active', i === currentIndex);
        });
      }

      function nextSlide() {
        goToSlide(currentIndex + 1);
      }

      // Auto-scroll every 4 seconds
      function startAutoScroll() {
        interval = setInterval(nextSlide, 4000);
      }

      // Pause auto-scroll when hovering
      container.addEventListener('mouseenter', () => clearInterval(interval));
      container.addEventListener('mouseleave', startAutoScroll);

      // Dot click handlers
      dots.forEach(dot => {
        dot.addEventListener('click', function() {
          const slideIndex = parseInt(this.getAttribute('data-slide'));
          goToSlide(slideIndex);
        });
      });

      // Start auto-scroll
      startAutoScroll();

      // Navigation buttons
      const navButtons = document.querySelectorAll('.nav-button');
      navButtons.forEach(button => {
        button.addEventListener('click', function() {
          navButtons.forEach(btn => btn.classList.remove('active', 'text-[#7B5FFF]'));
          this.classList.add('active', 'text-[#7B5FFF]');
        });
      });

      // Game card hover effect
      const gameCards = document.querySelectorAll('.game-card');
      gameCards.forEach(card => {
        card.addEventListener('click', function() {
          // Here you would typically navigate to a product page
          console.log('Navigating to game details');
        });
      });

      // Auth Modal Elements
      const authModal = document.getElementById('authModal');
      const closeModal = document.getElementById('closeModal');
      const authButton = document.getElementById('authButton');
      const loginTab = document.getElementById('loginTab');
      const registerTab = document.getElementById('registerTab');
      const loginForm = document.getElementById('loginForm');
      const registerForm = document.getElementById('registerForm');
      const loginBtn = document.getElementById('loginBtn');
      const registerBtn = document.getElementById('registerBtn');
      const forgotPassword = document.getElementById('forgotPassword');
      const googleLoginBtn = document.getElementById('googleLoginBtn');
      const googleRegisterBtn = document.getElementById('googleRegisterBtn');
      const switchToRegister = document.getElementById('switchToRegister');
      const switchToLogin = document.getElementById('switchToLogin');
      
      // Account Modal Elements
      const accountModal = document.getElementById('accountModal');
      const closeAccountModal = document.getElementById('closeAccountModal');
      const accountButton = document.getElementById('accountButton');
      const accountInfo = document.getElementById('accountInfo');
      const logoutBtn = document.getElementById('logoutBtn');
      const topupBalanceBtn = document.getElementById('topupBalanceBtn');
      const historyBtn = document.getElementById('historyBtn');
      
      // Top-up Modal Elements
      const topupModal = document.getElementById('topupModal');
      const closeTopupModal = document.getElementById('closeTopupModal');
      const topupAmount = document.getElementById('topupAmount');
      const paymentMethods = document.querySelectorAll('.payment-method');
      const confirmTopupBtn = document.getElementById('confirmTopupBtn');
      
      // Payment Modal Elements
      const paymentModal = document.getElementById('paymentModal');
      const closePaymentModal = document.getElementById('closePaymentModal');
      const paymentDetails = document.getElementById('paymentDetails');
      const completePaymentBtn = document.getElementById('completePaymentBtn');
      const cancelPaymentBtn = document.getElementById('cancelPaymentBtn');
      
      // History Modal Elements
      const historyModal = document.getElementById('historyModal');
      const closeHistoryModal = document.getElementById('closeHistoryModal');
      const historyList = document.getElementById('historyList');
      const historyTabs = document.querySelectorAll('.history-modal .category-tab');
      
      // Game Top-up Modal Elements
      const gameTopupModal = document.getElementById('gameTopupModal');
      const closeGameTopupModal = document.getElementById('closeGameTopupModal');
      const gameTopupTitle = document.getElementById('gameTopupTitle');
      const gamePlayerId = document.getElementById('gamePlayerId');
      const gameServerId = document.getElementById('gameServerId');
      const topupOptions = document.getElementById('topupOptions');
      const confirmGameTopupBtn = document.getElementById('confirmGameTopupBtn');
      
      // Notification button
      const notificationBtn = document.getElementById('notificationBtn');
      const notificationBadge = document.getElementById('notificationBadge');
      
      // Selected payment method and top-up option
      let selectedPaymentMethod = null;
      let selectedTopupOption = null;
      let currentGameId = null;
      
      // Show toast notification
      function showToast(message, type = 'success') {
        const icon = type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle';
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.innerHTML = `<i class="fas ${icon}"></i><span>${message}</span>`;
        document.body.appendChild(toast);
        
        // Remove toast after animation
        setTimeout(() => {
          toast.remove();
        }, 3000);
      }

      // Show auth modal
      authButton.addEventListener('click', () => {
        authModal.style.display = 'flex';
      });

      // Close modals
      closeModal.addEventListener('click', () => {
        authModal.style.display = 'none';
      });

      closeAccountModal.addEventListener('click', () => {
        accountModal.style.display = 'none';
      });

      closeTopupModal.addEventListener('click', () => {
        topupModal.style.display = 'none';
      });

      closePaymentModal.addEventListener('click', () => {
        paymentModal.style.display = 'none';
      });

      closeHistoryModal.addEventListener('click', () => {
        historyModal.style.display = 'none';
      });

      closeGameTopupModal.addEventListener('click', () => {
        gameTopupModal.style.display = 'none';
      });

      // Switch between login and register tabs
      loginTab.addEventListener('click', () => {
        loginTab.classList.add('active');
        registerTab.classList.remove('active');
        loginForm.style.display = 'block';
        registerForm.style.display = 'none';
      });

      registerTab.addEventListener('click', () => {
        registerTab.classList.add('active');
        loginTab.classList.remove('active');
        registerForm.style.display = 'block';
        loginForm.style.display = 'none';
      });

      // Switch between forms using footer links
      switchToRegister.addEventListener('click', (e) => {
        e.preventDefault();
        registerTab.click();
      });

      switchToLogin.addEventListener('click', (e) => {
        e.preventDefault();
        loginTab.click();
      });

      // Account button click handler
      accountButton.addEventListener('click', () => {
        if (auth.currentUser) {
          loadAccountInfo();
          accountModal.style.display = 'flex';
        } else {
          authModal.style.display = 'flex';
        }
      });

      // Top-up balance button
      topupBalanceBtn.addEventListener('click', () => {
        accountModal.style.display = 'none';
        topupModal.style.display = 'flex';
      });

      // History button
      historyBtn.addEventListener('click', () => {
        accountModal.style.display = 'none';
        historyModal.style.display = 'flex';
        loadTransactionHistory();
      });

      // Notification button
      notificationBtn.addEventListener('click', () => {
        // In a real app, this would show notifications
        showToast('Tidak ada notifikasi baru', 'info');
        notificationBadge.style.display = 'none';
      });

      // Payment method selection
      paymentMethods.forEach(method => {
        method.addEventListener('click', function() {
          paymentMethods.forEach(m => m.classList.remove('selected'));
          this.classList.add('selected');
          selectedPaymentMethod = this.getAttribute('data-method');
        });
      });

      // Confirm top-up
      confirmTopupBtn.addEventListener('click', () => {
        const amount = parseInt(topupAmount.value);
        
        if (!amount || amount < 10000) {
          showError('topupAmountError', 'Minimum top-up Rp 10.000');
          return;
        }
        
        if (!selectedPaymentMethod) {
          showError('paymentMethodError', 'Pilih metode pembayaran');
          return;
        }
        
        // Calculate admin fee based on payment method
        let adminFee = 2500; // Default for e-wallets
        if (selectedPaymentMethod === 'bank') {
          adminFee = 3000;
        }
        
        const total = amount + adminFee;
        
        // Show payment confirmation
        paymentDetails.innerHTML = `
          <div class="space-y-3">
            <div class="flex justify-between">
              <span class="text-[#B9B9B9]">Jumlah Top Up:</span>
              <span class="font-medium">Rp ${amount.toLocaleString()}</span>
            </div>
            <div class="flex justify-between">
              <span class="text-[#B9B9B9]">Biaya Admin:</span>
              <span class="font-medium">Rp ${adminFee.toLocaleString()}</span>
            </div>
            <div class="flex justify-between text-lg font-bold mt-2">
              <span>Total:</span>
              <span class="text-[#7B5FFF]">Rp ${total.toLocaleString()}</span>
            </div>
            <div class="mt-4 p-3 bg-[#2B2360] rounded-lg">
              <div class="font-medium mb-1">Instruksi Pembayaran:</div>
              <div class="text-sm text-[#B9B9B9]">
                ${getPaymentInstructions(selectedPaymentMethod)}
              </div>
            </div>
          </div>
        `;
        
        topupModal.style.display = 'none';
        paymentModal.style.display = 'flex';
      });

      // Complete payment
      completePaymentBtn.addEventListener('click', () => {
        const amount = parseInt(topupAmount.value);
        const user = auth.currentUser;
        
        if (!user) {
          showToast('Anda harus login terlebih dahulu', 'error');
          paymentModal.style.display = 'none';
          authModal.style.display = 'flex';
          return;
        }
        
        // In a real app, you would verify the payment with your backend
        // Here we'll just simulate a successful payment
        showLoading(completePaymentBtn, 'Memproses...');
        
        setTimeout(() => {
          // Update user balance in Firestore
          db.collection('users').doc(user.uid).get()
            .then(doc => {
              if (doc.exists) {
                const currentBalance = doc.data().balance || 0;
                const newBalance = currentBalance + amount;
                
                return db.collection('users').doc(user.uid).update({
                  balance: newBalance
                });
              }
            })
            .then(() => {
              // Record transaction
              return db.collection('transactions').add({
                userId: user.uid,
                type: 'topup',
                amount: amount,
                method: selectedPaymentMethod,
                status: 'completed',
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
              });
            })
            .then(() => {
              paymentModal.style.display = 'none';
              showToast('Top up berhasil! Saldo telah ditambahkan', 'success');
              loadAccountInfo(); // Refresh account info
            })
            .catch(error => {
              console.error('Error completing payment:', error);
              showToast('Gagal memproses pembayaran', 'error');
            })
            .finally(() => {
              hideLoading(completePaymentBtn, 'Saya Sudah Bayar');
            });
        }, 1500);
      });

      // Cancel payment
      cancelPaymentBtn.addEventListener('click', () => {
        paymentModal.style.display = 'none';
        topupModal.style.display = 'flex';
      });

      // Game top-up buttons
      document.querySelectorAll('.top-up-btn').forEach(button => {
        button.addEventListener('click', function() {
          const gameName = this.getAttribute('data-game');
          const gameId = this.getAttribute('data-game-id');
          
          if (!auth.currentUser) {
            showToast('Anda harus login terlebih dahulu', 'error');
            authModal.style.display = 'flex';
            return;
          }
          
          currentGameId = gameId;
          gameTopupTitle.textContent = `Top Up ${gameName}`;
          
          // Load top-up options
          topupOptions.innerHTML = '';
          const options = gameTopupOptions[gameId] || [];
          
          options.forEach((option, index) => {
            const optionElement = document.createElement('div');
            optionElement.className = 'topup-item';
            optionElement.setAttribute('data-index', index);
            
            let bonusText = '';
            if (option.bonus > 0) {
              bonusText = `<div class="text-xs text-[#7B5FFF] mt-1">+ Bonus ${option.bonus}</div>`;
            }
            
            optionElement.innerHTML = `
              <div class="font-medium">${option.amount} ${gameId === 'genshin' || gameId === 'honkaistarrail' ? 'Genesis Crystals' : 'Diamond'}</div>
              <div class="text-sm text-[#B9B9B9]">Rp ${option.price.toLocaleString()}</div>
              ${bonusText}
            `;
            
            optionElement.addEventListener('click', function() {
              document.querySelectorAll('.topup-item').forEach(item => {
                item.classList.remove('selected');
              });
              this.classList.add('selected');
              selectedTopupOption = option;
            });
            
            topupOptions.appendChild(optionElement);
          });
          
          gameTopupModal.style.display = 'flex';
        });
      });

      // Confirm game top-up
      confirmGameTopupBtn.addEventListener('click', () => {
        const playerId = gamePlayerId.value;
        
        if (!playerId) {
          showError('gamePlayerIdError', 'Masukkan ID Player');
          return;
        }
        
        if (!selectedTopupOption) {
          showError('topupOptionError', 'Pilih nominal top-up');
          return;
        }
        
        const user = auth.currentUser;
        if (!user) {
          showToast('Anda harus login terlebih dahulu', 'error');
          gameTopupModal.style.display = 'none';
          authModal.style.display = 'flex';
          return;
        }
        
        // Check user balance
        db.collection('users').doc(user.uid).get()
          .then(doc => {
            if (doc.exists) {
              const currentBalance = doc.data().balance || 0;
              const price = selectedTopupOption.price;
              
              if (currentBalance < price) {
                showToast('Saldo tidak cukup, silakan top up terlebih dahulu', 'error');
                gameTopupModal.style.display = 'none';
                topupModal.style.display = 'flex';
                return;
              }
              
              // Deduct balance
              const newBalance = currentBalance - price;
              
              showLoading(confirmGameTopupBtn, 'Memproses...');
              
              return db.collection('users').doc(user.uid).update({
                balance: newBalance
              }).then(() => {
                // Record transaction
                return db.collection('transactions').add({
                  userId: user.uid,
                  type: 'game',
                  gameId: currentGameId,
                  gameName: gameTopupTitle.textContent.replace('Top Up ', ''),
                  playerId: playerId,
                  serverId: gameServerId.value || '',
                  amount: selectedTopupOption.amount,
                  price: price,
                  status: 'completed',
                  createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
              });
            }
          })
          .then(() => {
            gameTopupModal.style.display = 'none';
            showToast('Top up game berhasil!', 'success');
            loadAccountInfo(); // Refresh account info
            
            // Reset form
            gamePlayerId.value = '';
            gameServerId.value = '';
            document.querySelectorAll('.topup-item').forEach(item => {
              item.classList.remove('selected');
            });
            selectedTopupOption = null;
          })
          .catch(error => {
            console.error('Error processing game top-up:', error);
            showToast('Gagal memproses top up game', 'error');
          })
          .finally(() => {
            hideLoading(confirmGameTopupBtn, 'Lanjutkan Pembayaran');
          });
      });

      // Load transaction history
      function loadTransactionHistory(category = 'all') {
        const user = auth.currentUser;
        if (!user) return;
        
        let query = db.collection('transactions')
          .where('userId', '==', user.uid)
          .orderBy('createdAt', 'desc')
          .limit(10);
          
        if (category !== 'all') {
          query = query.where('type', '==', category);
        }
        
        query.get()
          .then(querySnapshot => {
            if (querySnapshot.empty) {
              historyList.innerHTML = `
                <div class="text-center py-10 text-[#B9B9B9]">
                  <i class="fas fa-history text-3xl mb-2"></i>
                  <p>Belum ada riwayat transaksi</p>
                </div>
              `;
              return;
            }
            
            historyList.innerHTML = '';
            
            querySnapshot.forEach(doc => {
              const data = doc.data();
              const date = data.createdAt ? data.createdAt.toDate() : new Date();
              
              let description = '';
              let icon = 'fa-coins';
              let iconColor = 'text-[#7B5FFF]';
              
              if (data.type === 'topup') {
                description = `Top Up Saldo (${data.method})`;
              } else if (data.type === 'game') {
                description = `${data.gameName} - ${data.amount} ${currentGameId === 'genshin' || currentGameId === 'honkaistarrail' ? 'Genesis Crystals' : 'Diamond'}`;
                icon = 'fa-gamepad';
                iconColor = 'text-[#FF5F7E]';
              } else if (data.type === 'voucher') {
                description = `Voucher ${data.voucherName}`;
                icon = 'fa-ticket-alt';
                iconColor = 'text-[#5FFF8B]';
              }
              
              const historyItem = document.createElement('div');
              historyItem.className = 'history-item';
              historyItem.innerHTML = `
                <div class="flex justify-between items-start">
                  <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full ${iconColor} bg-[#2B2360] flex items-center justify-center mr-3">
                      <i class="fas ${icon}"></i>
                    </div>
                    <div>
                      <div class="font-medium">${description}</div>
                      <div class="text-xs text-[#B9B9B9]">${formatDate(date)}</div>
                    </div>
                  </div>
                  <div class="text-right">
                    <div class="font-medium ${data.type === 'topup' ? 'text-[#5FFF8B]' : 'text-white'}">${data.type === 'topup' ? '+' : '-'}Rp ${data.price?.toLocaleString() || data.amount?.toLocaleString()}</div>
                    <div class="text-xs text-[#B9B9B9]">${data.status || 'completed'}</div>
                  </div>
                </div>
              `;
              
              historyList.appendChild(historyItem);
            });
          })
          .catch(error => {
            console.error('Error loading history:', error);
            historyList.innerHTML = `
              <div class="text-center py-10 text-[#FF5F7E]">
                <i class="fas fa-exclamation-circle text-3xl mb-2"></i>
                <p>Gagal memuat riwayat transaksi</p>
              </div>
            `;
          });
      }

      // History category tabs
      document.querySelectorAll('#historyModal .category-tab').forEach(tab => {
        tab.addEventListener('click', function() {
          document.querySelectorAll('#historyModal .category-tab').forEach(t => {
            t.classList.remove('active');
          });
          this.classList.add('active');
          const category = this.getAttribute('data-category');
          loadTransactionHistory(category);
        });
      });

      // Google Login
      function googleAuth() {
        auth.signInWithPopup(provider)
          .then((result) => {
            // Check if user is new
            const isNewUser = result.additionalUserInfo.isNewUser;
            const user = result.user;
            
            if (isNewUser) {
              // Save user data to Firestore
              return db.collection('users').doc(user.uid).set({
                name: user.displayName || 'User',
                email: user.email,
                phone: user.phoneNumber || '',
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                balance: 0
              });
            }
          })
          .then(() => {
            authModal.style.display = 'none';
            authButton.textContent = 'Akun Saya';
            showToast('Login berhasil!', 'success');
            notificationBadge.style.display = 'block'; // Show notification badge
          })
          .catch((error) => {
            console.error('Google Auth Error:', error);
            showToast('Login dengan Google gagal: ' + error.message, 'error');
          });
      }

      googleLoginBtn.addEventListener('click', googleAuth);
      googleRegisterBtn.addEventListener('click', googleAuth);

      // Forgot password
      forgotPassword.addEventListener('click', (e) => {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value;
        
        if (!email) {
          showError('loginEmailError', 'Masukkan email Anda terlebih dahulu');
          return;
        }
        
        auth.sendPasswordResetEmail(email)
          .then(() => {
            showToast('Email reset password telah dikirim. Silakan cek inbox Anda.', 'success');
          })
          .catch(error => {
            showError('loginEmailError', error.message);
          });
      });

      // Login function
      loginBtn.addEventListener('click', () => {
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        // Reset errors
        hideError('loginEmailError');
        hideError('loginPasswordError');
        
        // Validate inputs
        if (!email) {
          showError('loginEmailError', 'Email harus diisi');
          return;
        }
        
        if (!password) {
          showError('loginPasswordError', 'Password harus diisi');
          return;
        }
        
        showLoading(loginBtn, 'Memproses...');
        
        auth.signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // Success
            authModal.style.display = 'none';
            authButton.textContent = 'Akun Saya';
            showToast('Login berhasil!', 'success');
            notificationBadge.style.display = 'block'; // Show notification badge
          })
          .catch((error) => {
            // Handle errors
            if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
              showError('loginPasswordError', 'Email atau password salah');
            } else {
              showError('loginPasswordError', error.message);
            }
          })
          .finally(() => {
            hideLoading(loginBtn, 'Login');
          });
      });

      // Register function
      registerBtn.addEventListener('click', () => {
        const name = document.getElementById('registerName').value;
        const email = document.getElementById('registerEmail').value;
        const phone = document.getElementById('registerPhone').value;
        const password = document.getElementById('registerPassword').value;
        const confirmPassword = document.getElementById('registerConfirmPassword').value;
        
        // Reset errors
        hideError('registerNameError');
        hideError('registerEmailError');
        hideError('registerPhoneError');
        hideError('registerPasswordError');
        hideError('registerConfirmPasswordError');
        
        // Validate inputs
        if (!name) {
          showError('registerNameError', 'Nama harus diisi');
          return;
        }
        
        if (!email) {
          showError('registerEmailError', 'Email harus diisi');
          return;
        }
        
        if (!phone) {
          showError('registerPhoneError', 'Nomor telepon harus diisi');
          return;
        }
        
        if (!password) {
          showError('registerPasswordError', 'Password harus diisi');
          return;
        }
        
        if (password.length < 6) {
          showError('registerPasswordError', 'Password minimal 6 karakter');
          return;
        }
        
        if (password !== confirmPassword) {
          showError('registerConfirmPasswordError', 'Password tidak cocok');
          return;
        }
        
        showLoading(registerBtn, 'Mendaftar...');
        
        // Create user
        auth.createUserWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // Save additional user data to Firestore
            return db.collection('users').doc(userCredential.user.uid).set({
              name: name,
              email: email,
              phone: phone,
              createdAt: firebase.firestore.FieldValue.serverTimestamp(),
              balance: 0
            });
          })
          .then(() => {
            // Success
            authModal.style.display = 'none';
            authButton.textContent = 'Akun Saya';
            showToast('Pendaftaran berhasil!', 'success');
            notificationBadge.style.display = 'block'; // Show notification badge
          })
          .catch((error) => {
            // Handle errors
            if (error.code === 'auth/email-already-in-use') {
              showError('registerEmailError', 'Email sudah terdaftar');
            } else {
              showError('registerEmailError', error.message);
            }
          })
          .finally(() => {
            hideLoading(registerBtn, 'Daftar');
          });
      });

      // Logout function
      logoutBtn.addEventListener('click', () => {
        auth.signOut()
          .then(() => {
            accountModal.style.display = 'none';
            authButton.textContent = 'Login/Daftar';
            showToast('Anda telah logout', 'success');
            notificationBadge.style.display = 'none'; // Hide notification badge
          })
          .catch((error) => {
            showToast('Gagal logout: ' + error.message, 'error');
          });
      });

      // Load account info
      function loadAccountInfo() {
        const user = auth.currentUser;
        if (user) {
          db.collection('users').doc(user.uid).get()
            .then((doc) => {
              if (doc.exists) {
                const userData = doc.data();
                accountInfo.innerHTML = `
                  <div class="flex items-center justify-center mb-4">
                    <div class="w-16 h-16 rounded-full bg-[#7B5FFF] flex items-center justify-center text-2xl font-bold">
                      ${userData.name.charAt(0).toUpperCase()}
                    </div>
                  </div>
                  <div class="space-y-2">
                    <div class="flex justify-between">
                      <span class="text-[#B9B9B9]">Nama:</span>
                      <span class="font-medium">${userData.name}</span>
                    </div>
                    <div class="flex justify-between">
                      <span class="text-[#B9B9B9]">Email:</span>
                      <span class="font-medium">${user.email}</span>
                    </div>
                    <div class="flex justify-between">
                      <span class="text-[#B9B9B9]">Telepon:</span>
                      <span class="font-medium">${userData.phone || '-'}</span>
                    </div>
                    <div class="flex justify-between">
                      <span class="text-[#B9B9B9]">Saldo:</span>
                      <span class="font-medium text-[#7B5FFF]">Rp ${userData.balance?.toLocaleString() || '0'}</span>
                    </div>
                  </div>
                `;
              } else {
                accountInfo.innerHTML = '<p>Data pengguna tidak ditemukan</p>';
              }
            })
            .catch((error) => {
              accountInfo.innerHTML = `<p class="text-red-500">Error: ${error.message}</p>`;
            });
        }
      }

      // Helper functions
      function showError(elementId, message) {
        const element = document.getElementById(elementId);
        element.textContent = message;
        element.style.display = 'block';
      }

      function hideError(elementId) {
        const element = document.getElementById(elementId);
        element.style.display = 'none';
      }
      
      function showLoading(button, text) {
        const spinner = button.querySelector('.spinner');
        const textSpan = button.querySelector('span');
        
        spinner.style.display = 'inline-block';
        textSpan.textContent = text;
        button.disabled = true;
      }
      
      function hideLoading(button, text) {
        const spinner = button.querySelector('.spinner');
        const textSpan = button.querySelector('span');
        
        spinner.style.display = 'none';
        textSpan.textContent = text;
        button.disabled = false;
      }
      
      function formatDate(date) {
        const options = { day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' };
        return date.toLocaleDateString('id-ID', options);
      }
      
      function getPaymentInstructions(method) {
        switch(method) {
          case 'gopay':
            return '1. Buka aplikasi Gojek<br>2. Pilih "Bayar"<br>3. Scan QR code yang muncul<br>4. Konfirmasi pembayaran';
          case 'ovo':
            return '1. Buka aplikasi OVO<br>2. Pilih "Transfer"<br>3. Masukkan nomor 081234567890<br>4. Masukkan jumlah pembayaran<br>5. Konfirmasi pembayaran';
          case 'dana':
            return '1. Buka aplikasi DANA<br>2. Pilih "Kirim"<br>3. Masukkan nomor 081234567890<br>4. Masukkan jumlah pembayaran<br>5. Konfirmasi pembayaran';
          case 'bank':
            return '1. Transfer ke rekening BCA 1234567890 a.n. PediaPay<br>2. Masukkan jumlah pembayaran<br>3. Konfirmasi dengan mengirim bukti transfer';
          default:
            return 'Silakan selesaikan pembayaran sesuai metode yang dipilih';
        }
      }

      // Check auth state and persist login
      auth.onAuthStateChanged((user) => {
        if (user) {
          authButton.textContent = 'Akun Saya';
          loadAccountInfo();
          // Check for unread notifications
          notificationBadge.style.display = 'block';
        } else {
          authButton.textContent = 'Login/Daftar';
          notificationBadge.style.display = 'none';
        }
      });

      // Persist auth state across page reloads
      auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL)
        .then(() => {
          // Existing and future Auth states are now persisted in the current
          // session only. Closing the window would clear any existing state even
          // if a user forgets to sign out.
          // ...
        })
        .catch((error) => {
          // Handle Errors here.
          console.error('Error setting auth persistence:', error);
        });
    });
  </script>
</body>
</html>
